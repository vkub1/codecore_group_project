<% if @facility.errors.any? %>
    <% @facility.errors.full_messages.each do |error| %>
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
        <strong>Ooops! </strong><%= error %>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        </div>
    <% end %>
<% end%>

    <%= form_with model: @facility do |form| %>
    <div>
        <%= form.label :full_address %>
        <br>
        <%= form.text_field :full_address %>
    </div>
    <div>
        <%= form.label :features %>
        <br>
        <%= form.text_field :features %>
    </div>
    <div>
        <%= form.label :description %>
        <br>
        <%= form.text_area :description, cols: 50, rows: 5 %>
        <br>
        <div class="tag-container">
        <input class="tag-search" type="text" placeholder="Search by category..">
        <%# form.collection_check_boxes :tag_ids, Tag.order(name: :ASC), :id, :name do |t| %>
            
            <div class="tag-wrapper">
                <%= form.label :tag_names %>
                <%= form.text_field :tag_names %>
            </div>
            <%# end %>
        </div>
        
        </div>
    </div>
    <%= form.submit %>
    <% end %>

<script>
    
    $(function(){
        $('#facility_tag_names').selectize({
            delimeter: ',',
            persist: false,
            labelField: 'name', //Column name in db  
            valueField: 'name', //Column name in db
            searchField: 'name', //Column in db
            options: <% Tag.select(:name).to_json(except: [:id]).html_safe %>,
            //The above line selects only names from tags table and converts them to
            //a json array of objects without including ids and makes sure its safe html string
            //options: [{"name": "first tag"}, {"name":"second tag"}, ..., {"name": "last tag"}]
            create: function(input) {
                return {
                    name: input
                }
            }
        })
    })
    })
</script>

