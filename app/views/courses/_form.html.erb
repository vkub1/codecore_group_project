<% if @course.errors.any? %>
  <ul>
    <% @course.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
  </ul>
<% end %>

<%= form_with model:@course do |form|%>

    <%= form.label :title%>
    <br>
   
    <%= form.text_field :title%>
    
    <br>
    <%= form.label :description%>
    <br>
    <%= form.text_area :description%>
    <br>
    <%= form.label :max_students%>
    <%= form.number_field :max_students, in: 1.0..30.0, step: 1 %>
    <br>
    <div class="tag-container">
            <div class="tag-wrapper">
                <%= form.label :tag_names %>
                <%= form.text_field :tag_names %>
            </div>
    </div>
    <%= form.submit nil, class:"btn btn-outline-primary" %>

    <%= %>
<% end %>


<script>
    
    $(function(){
        $('#course_tag_names').selectize({
            delimeter: ',',
            persist: false,
            labelField: 'name', //Column name in db  
            valueField: 'name', //Column name in db
            searchField: 'name', //Column in db
            options: <%= Tag.joins("LEFT JOIN taggings ON tags.id = taggings.tag_id").where('course_id IS NOT NULL').select(:name).to_json(except: [:id]).html_safe %>,
            //The above line selects only names from tags table and converts them to
            //a json array of objects without including ids and makes sure its safe html string
            //options: [{"name": "first tag"}, {"name":"second tag"}, ..., {"name": "last tag"}]
            create: function(input) {
                return {
                    name: input
                }
            }
        })
    })
</script>
